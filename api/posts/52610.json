{"title":"攻防世界 guess_num","slug":"攻防世界pwn-guess_num","date":"2020-05-08","updated":"2020-05-08","comments":true,"path":"api/posts/52610.json","excerpt":null,"cover":"https://i.loli.net/2020/05/08/9dWjqTSBtmRkHgG.png","covers":["https://i.loli.net/2020/05/08/9dWjqTSBtmRkHgG.png","https://i.loli.net/2020/05/08/QgLDtJBZlhXYyFa.png","https://i.loli.net/2020/05/08/hltLr1UKMu6qmcG.png","https://i.loli.net/2020/05/08/UXbv96WNxFriu3k.png","https://i.loli.net/2020/05/08/LoDke3q2xhGSPHU.png","https://s1.ax1x.com/2020/05/08/YnNVrd.png","https://s1.ax1x.com/2020/05/08/YnNMPf.png"],"content":"<p>查看关键 main()函数，发现 gets(&amp;v11)存在栈溢出</p>\n<p><img src=\"https://i.loli.net/2020/05/08/9dWjqTSBtmRkHgG.png\" alt=\"17627983-c6ff7c8db83a9ec7.png\"></p>\n<p>进入 sub_C3E()函数，确定满足条件即可 cat flag。</p>\n<p><img src=\"https://i.loli.net/2020/05/08/QgLDtJBZlhXYyFa.png\" alt=\"17627983-1e961fbba4dff1bc.png\"></p>\n<p>题目要求，先输入 name, 然后连续十次猜对数字得到 flag, 进入 V11, 在栈中占 0x20，可以覆盖到 seed，使 seed[0]已知，后使输入的 v8 等于随机数 v10, 拿到 flag。</p>\n<blockquote>\n<p>注：<br>（1）在调用 rang()时，先利用 srand()设好随机数种子，若未设置，rand()在调用的时候会自动设为 1.<br>（2）libc 共享库：可以使用命令 ldd guess_num 查找 <br>（3）如何在脚本中调用动态库中的程序：python 库 ctypes 模块，使用 cdll.LoadLibrary(‘’)<br>(4) 什么情况程序在编译前加载了动态库：比如我们在使用 print 家族、puts 等未在程序里声明的函数，需要通过引用动态库里面就有程序不用声明就能进行调用的函数。</p>\n</blockquote>\n<p>exp:</p>\n<p><img src=\"https://i.loli.net/2020/05/08/hltLr1UKMu6qmcG.png\" alt=\"17627983-82da413e439821bd.png\"></p>\n<blockquote>\n<p>解释：<br>引入 pwn、ctypes 模块；<br>remote 连接其他主机服务；<br>elf=ELF(bin 路径)本地运行 pwn 文件；<br>libc 调用动态库; 构造 payload, 随机数 a 覆盖到 seed[0], 设定随机数种子为 1；<br>recvuntil()接收字符串；<br>sendline(payload)发送 payload；<br>srand(1)设定随机数种子为 1；<br>循环十次；<br>interactive()直接进行交互；</p>\n</blockquote>\n<p><img src=\"https://i.loli.net/2020/05/08/UXbv96WNxFriu3k.png\" alt=\"17627983-caa9a4e5b8ce9f1a.png\"></p>\n<p>另一种方式：利用 C 程序，直接覆盖 seed, 爆出随机数，得到 flag.</p>\n<p><img src=\"https://i.loli.net/2020/05/08/LoDke3q2xhGSPHU.png\" alt=\"17627983-93fb0ad7c552854b.png\"></p>\n<p><img src=\"https://s1.ax1x.com/2020/05/08/YnNVrd.png\" alt=\"YnNVrd.png\"></p>\n<p><img src=\"https://s1.ax1x.com/2020/05/08/YnNMPf.png\" alt=\"YnNMPf.png\"></p>\n<p>cyberpeace{c89cf2a54c56f16458a1164851a361b4}</p>\n","url":"/posts/52610/","min2read":1,"word4post":344,"prev_post":{"title":"CVE-2019-5786","url":"/posts/23309/"},"next_post":{"title":"攻防世界 string","url":"/posts/54486/"},"toc":"","categories":[],"tags":[{"name":"pwn","path":"api/tags/pwn.json","url":"/tags/pwn/"}]}