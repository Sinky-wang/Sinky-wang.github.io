{"title":"Ubuntu 下 buildroot 以及 qemu 环境搭建","slug":"Ubuntu下buildroot以及qemu环境搭建","date":"2020-09-08","updated":"2020-09-10","comments":true,"path":"api/posts/2371.json","excerpt":null,"cover":null,"covers":null,"content":"<h1 id=\"0x00- 搭建环境\"><a href=\"#0x00- 搭建环境\" class=\"headerlink\" title=\"0x00 搭建环境\"></a>0x00 搭建环境</h1><p>windows 10<br>VMwareWorkstation pro<br>Ubuntu 16.04 x64</p>\n<h1 id=\"0x01- 安装 binwalk\"><a href=\"#0x01- 安装 binwalk\" class=\"headerlink\" title=\"0x01 安装 binwalk\"></a>0x01 安装 binwalk</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo su</span><br><span class=\"line\">sudo apt-get remove binwalk</span><br><span class=\"line\">sudo spt-get update</span><br><span class=\"line\">sudo apt-get install build-essential autoconf git &#x2F;&#x2F; 获取 Git</span><br><span class=\"line\">git clone https:&#x2F;&#x2F;github.com&#x2F;devttys0&#x2F;binwalk</span><br><span class=\"line\">cd binwalk</span><br><span class=\"line\">sudo python setup.py install</span><br><span class=\"line\">sudo .&#x2F;deps.sh</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"0x02- 安装 buildroot 交叉编译环境\"><a href=\"#0x02- 安装 buildroot 交叉编译环境\" class=\"headerlink\" title=\"0x02 安装 buildroot 交叉编译环境\"></a>0x02 安装 buildroot 交叉编译环境 </h1><p> 安装依赖：</p>\n<p><code>sudo apt-get install libncurses5-dev patch</code></p>\n<p>下载 buildroot:</p>\n<p><code>wget https://buildroot.org/downloads/buildroot-2020.02.6.tar.gz</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tar -zxvf buildroot-2020.02.6.tar.gz</span><br><span class=\"line\">cd buildroot-2020.02.6</span><br><span class=\"line\">make clean</span><br><span class=\"line\">make menuconfig</span><br></pre></td></tr></table></figure>\n\n<p>出现配置界面：</p>\n<ul>\n<li>选择 target options-&gt;target Architecture-&gt;MIPS(Little endian), 代表 MIPS 小端序</li>\n<li>在 toolChain–&gt;Kelnel Headers, 选择自己主机内核版本或更低版本。</li>\n<li>保存退出</li>\n</ul>\n<p><code>sudo make</code></p>\n<p>静等完成。</p>\n<p>os：编译的时候需要大内存，我分配个虚拟机的内存太小，导致编译失败了好几次……此处多谢 Prowes5 帮我找到了原因呜呜呜。</p>\n<p>测试：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.&#x2F;mipsel-linux-gcc hello.c -o hello</span><br><span class=\"line\">.&#x2F;hello &#x2F;&#x2F; 失败</span><br></pre></td></tr></table></figure>\n\n<p>使用 file 查看，是小端序的 mips 程序。</p>\n<h1 id=\"0x03-qemu 运行环境\"><a href=\"#0x03-qemu 运行环境\" class=\"headerlink\" title=\"0x03 qemu 运行环境\"></a>0x03 qemu 运行环境</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install qemu</span><br><span class=\"line\">sudo apt-get install qemu-user-static</span><br></pre></td></tr></table></figure>\n\n<p>测试 hello 报错<code>/lib/ld-uClibc.so.0: No such file or directory</code></p>\n<p>是因为没有对应架构的链接库的问题 <br> 在目录 output/host/mipsel-buildroot-linux-uclibc/sysroot/lib/ 下，</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo cp ld-uClibc-1.0.32.so &#x2F;lib&#x2F;</span><br><span class=\"line\">sudo chown -R root:root &#x2F;lib&#x2F;ld-uClibc-1.0.31.so</span><br><span class=\"line\">sudo ln -s &#x2F;lib&#x2F;ld-uClibc-1.0.32.so &#x2F;lib&#x2F;ld-uClibc.so.0</span><br></pre></td></tr></table></figure>\n\n<p>还是不行，cd /lib 目录下，删掉了原来的 ld-uClibc.so.0 文件，然后重新输入命令。</p>\n<p>出现新报错：<code>/home/test/buildroot-2019.02.4/hello: can&#39;t load library &#39;libc.so.0&#39;</code></p>\n<p>解决方案：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo cp libuClibc-1.0.31.so &#x2F;lib&#x2F;</span><br><span class=\"line\">sudo chown -R root:root &#x2F;lib&#x2F;libuClibc-1.0.32.so</span><br><span class=\"line\">sudo ln -s &#x2F;lib&#x2F;libuClibc-1.0.32.so &#x2F;lib&#x2F;libc.so.0</span><br></pre></td></tr></table></figure>\n\n<p>还是出现了文件不对应问题，cd /lib 下删掉了原来的 libc.so.0 文件，继续重新输入命令。</p>\n<p>运行成功。</p>\n<p>os: 为了找到出错点，我真是已经切换目录切换到全都背下来了……真的是一搭环境总会碰到所有的问题……霉霉本霉了。</p>\n<h1 id=\"0x04- 配置网络环境\"><a href=\"#0x04- 配置网络环境\" class=\"headerlink\" title=\"0x04 配置网络环境\"></a>0x04 配置网络环境</h1>","url":"/posts/2371/","min2read":2,"word4post":522,"prev_post":null,"next_post":{"title":"MIPS 架构学习笔记","url":"/posts/23648/"},"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" data-id=\"0x00- 搭建环境\" href = \"#\"><span class=\"toc-number\">1.</span> <span class=\"toc-text\">0x00 搭建环境</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" data-id=\"0x01- 安装 binwalk\" href = \"#\"><span class=\"toc-number\">2.</span> <span class=\"toc-text\">0x01 安装 binwalk</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" data-id=\"0x02- 安装 buildroot 交叉编译环境\" href = \"#\"><span class=\"toc-number\">3.</span> <span class=\"toc-text\">0x02 安装 buildroot 交叉编译环境 </span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" data-id=\"0x03-qemu 运行环境\" href = \"#\"><span class=\"toc-number\">4.</span> <span class=\"toc-text\">0x03 qemu 运行环境</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" data-id=\"0x04- 配置网络环境\" href = \"#\"><span class=\"toc-number\">5.</span> <span class=\"toc-text\">0x04 配置网络环境</span></a></li></ol>","categories":[],"tags":[{"name":"IOT","path":"api/tags/IOT.json","url":"/tags/IOT/"}]}